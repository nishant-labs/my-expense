import{H as w,u as G,G as U,r,j as e,x as F,y as g,F as N,E as D}from"./vendor-BiCOzrMY.js";import{f as M}from"./NumberUtils-DGiqd6yw.js";import{T as Y,s as _}from"./index-BvpDcwIy.js";import{h as $,a as Q,b as B,G as K}from"./ApiBase-DcR9eLOQ.js";import{Q as x,E as f,w as P}from"./index-Do_MZewB.js";import"./defineProperty-ChkGiTEg.js";const W=(c,o,a,n,t)=>[{headerName:"Name",field:"name"},{headerName:"Transactions",field:"matchers",cellRenderer:"listItemWithEditCellRenderer",cellRendererParams:{updateItem:a},valueFormatter:({value:l})=>l==null?void 0:l.join(""),minWidth:350,autoHeight:!0},{headerName:"Budget",field:"budget",minWidth:100,valueFormatter:({value:l})=>l?M(Number(l),!0,0):" "},{headerName:"Chart Color",field:"chartColor",minWidth:110,cellStyle:({value:l})=>({backgroundColor:l,color:"white"})},{headerName:"Transaction Source",field:"sourceId",valueFormatter:({value:l})=>{var h;return((h=t==null?void 0:t.find(p=>p.id===l))==null?void 0:h.name)??"Source Not Found"}},{headerName:"Action",type:"rightAligned",minWidth:140,cellRenderer:"rowActionCellRenderer",cellRendererParams:{deleteItem:c,toggleItem:o,editItem:n}}],H=()=>w({queryKey:x.CATEGORY_SETTINGS,meta:{endpoint:f.CATEGORY_SETTINGS}}),z=()=>{var a,n;const c=G(),o=(n=(a=c.getDefaultOptions().queries)==null?void 0:a.meta)==null?void 0:n.baseUrl;return U({mutationFn:t=>$(`${o}${f.CATEGORY_SETTINGS}`,t),onSuccess:()=>{c.invalidateQueries({queryKey:x.CATEGORY_SETTINGS})}})},J=()=>{var a,n;const c=G(),o=(n=(a=c.getDefaultOptions().queries)==null?void 0:a.meta)==null?void 0:n.baseUrl;return U({mutationFn:t=>Q(`${o}${f.CATEGORY_SETTINGS}/${t.id}`,t.payload),onSuccess:()=>{c.invalidateQueries({queryKey:x.CATEGORY_SETTINGS})}})},L=()=>{var a,n;const c=G(),o=(n=(a=c.getDefaultOptions().queries)==null?void 0:a.meta)==null?void 0:n.baseUrl;return U({mutationFn:t=>B(`${o}${f.CATEGORY_SETTINGS}/${t}`),onSuccess:()=>{c.invalidateQueries({queryKey:x.CATEGORY_SETTINGS})}})};function V(){const c=G(),o=H(),a=z(),n=L(),t=J(),l=c.getQueryData(x.SOURCE_SETTINGS),h=r.useCallback(async(d,i,S,u,y)=>a.mutateAsync({name:i,matchers:d,chartColor:S,sourceId:u,budget:y}),[a]),p=r.useCallback(async d=>n.mutateAsync(d.id),[n]),T=r.useCallback(async d=>t.mutateAsync({id:d.id,payload:{isEnabled:!d.isEnabled}}),[t]),j=r.useCallback(async(d,i,S,u,y,C)=>t.mutateAsync({id:d,payload:{name:S,matchers:i,chartColor:u,sourceId:y,budget:C}}),[t]),m=r.useCallback(async(d,i)=>t.mutateAsync({id:d.id,payload:{matchers:i}}),[t]);return{categories:o.data,sourceList:l,error:a.error||t.error||n.error,onSave:h,onDelete:p,onUpdate:j,onToggleStatus:T,onUpdateTransactions:m}}const X=()=>{const{categories:c,sourceList:o,error:a,onDelete:n,onSave:t,onUpdate:l,onToggleStatus:h,onUpdateTransactions:p}=V(),[T,j]=r.useState(null),[m,d]=r.useState([]),[i,S]=r.useState("#FFFFFF"),[u,y]=r.useState(""),[C,A]=r.useState(""),[E,R]=r.useState(""),b=r.useCallback(()=>{j(null),d([]),y(""),S(""),A(""),R("")},[]),O=r.useCallback(()=>{t(m,u,i,C,parseInt(E)).then(()=>{b()})},[t,m,u,i,C,E,b]),k=r.useCallback(()=>{l(T,m,u,i,C,parseInt(E)).then(()=>{b()})},[l,T,m,u,i,C,E,b]),v=r.useCallback(s=>{var I;j(s.id),d(s.matchers),y(s.name),S(s.chartColor),A(s.sourceId),R(((I=s.budget)==null?void 0:I.toString())||"")},[]),q=r.useMemo(()=>W(n,h,p,v,o),[v,n,h,p,o]);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Category Settings"}),e.jsxs(F,{className:"mb-2",children:[e.jsx(g,{children:e.jsx(N.Control,{placeholder:"Enter Label",value:u,onChange:s=>y(s.target.value)})}),e.jsx(g,{children:e.jsx(Y,{selected:m,options:m,onChange:d})}),e.jsx(g,{sm:2,children:e.jsx(N.Control,{placeholder:"Enter Budget",type:"number",step:"any",min:"1",value:E,onChange:s=>R(s.target.value)})}),e.jsx(g,{sm:1,children:e.jsx(N.Control,{type:"color",value:i,onChange:s=>S(s.target.value),title:"Choose your color"})}),e.jsx(g,{children:e.jsxs(N.Select,{"aria-label":"Source Selector",value:C,onChange:s=>A(s.target.value),children:[e.jsx("option",{children:"Select Source"}),o==null?void 0:o.map((s,I)=>e.jsx("option",{value:s.id,children:s.name},`source-${I}`))]})})]}),e.jsx(F,{children:e.jsxs(g,{className:"text-end",children:[e.jsx(D,{className:"mx-2",disabled:!u||m.length===0||!i||!C,onClick:T?k:O,children:T?"Update":"Add Category"}),e.jsx(D,{variant:"outline-secondary",onClick:b,children:"Clear"})]})}),e.jsx(F,{children:e.jsxs(g,{children:[e.jsx("p",{children:a==null?void 0:a.error}),e.jsx(K,{colDefs:q,rowData:c,components:_})]})})]})},re=P(X);export{X as CategorySettings,re as default};
