import{x as D,w as E,r as s,j as e,o as F,p as g,F as y,t as R}from"./vendor-EorjclcB.js";import{f as U}from"./NumberUtils-DGiqd6yw.js";import{w as $,T as L,s as _}from"./index-HHTTJgop.js";import{s as M,G as P}from"./selector-B91nXTBH.js";import{t as H,s as W}from"./selector-DeO6uDmu.js";import{i as q,d as z,u as k}from"./index-Dkm4UOKP.js";const J=(n,m,f,C,a)=>[{headerName:"Name",field:"name"},{headerName:"Transactions",field:"matchers",cellRenderer:"listItemWithEditCellRenderer",cellRendererParams:{updateItem:f},valueFormatter:l=>{var d;return(d=l==null?void 0:l.value)==null?void 0:d.join("")},width:350,autoHeight:!0},{headerName:"Budget",field:"budget",width:100,valueFormatter:l=>U(Number(l.value??0),!0,0)},{headerName:"Chart Color",field:"chartColor",width:110,cellStyle:l=>({backgroundColor:l.value,color:"white"}),valueFormatter:()=>" "},{headerName:"Transaction Source",field:"sourceId",valueFormatter:l=>{var d;return((d=a==null?void 0:a.find(x=>x.id===l.value))==null?void 0:d.name)??"Source Not Found"}},{headerName:"Action",type:"rightAligned",width:140,cellRenderer:"rowActionCellRenderer",cellRendererParams:{deleteItem:n,toggleItem:m,editItem:C}}];function K(){const n=D(H),m=E(W),f=E(M),[C,a]=s.useState(""),l=s.useCallback(async(t,o,c,p,i)=>{a("");const h=await q({name:o,matchers:t,chartColor:c,sourceId:p,budget:i});return h.error?a("Failed to create new group"):n(!0),h},[n]),d=s.useCallback(async t=>{a("");const o=await z(t.id);return o.error?a(`Failed to delete group with id ${t.id}`):n(!0),o},[n]),x=s.useCallback(async t=>{a("");const o=await k(t.id,{isEnabled:!t.isEnabled});return o.error?a(`Failed to toggle status for ${t.name}`):n(!0),o},[n]),S=s.useCallback(async(t,o,c,p,i,h)=>{a("");const u=await k(t,{name:c,matchers:o,chartColor:p,sourceId:i,budget:h});return u.error?a(`Failed to update for ${c}`):n(!0),u},[n]),w=s.useCallback(async(t,o)=>{a("");const c=await k(t.id,{matchers:o});return c.error?a(`Failed to update transaction for ${t.name}`):n(!0),c},[n]);return{groupList:m,sourceList:f,error:C,onSave:l,onDelete:d,onUpdate:S,onToggleStatus:x,onUpdateTransactions:w}}const O=()=>{const{groupList:n,sourceList:m,error:f,onDelete:C,onSave:a,onUpdate:l,onToggleStatus:d,onUpdateTransactions:x}=K(),[S,w]=s.useState(null),[t,o]=s.useState([]),[c,p]=s.useState("#000000"),[i,h]=s.useState(""),[u,I]=s.useState(""),[j,N]=s.useState(""),b=s.useCallback(()=>{w(null),o([]),h(""),p(""),I(""),N("")},[]),T=s.useCallback(()=>{a(t,i,c,u,parseInt(j)).then(()=>{b()})},[a,t,i,c,u,j,b]),A=s.useCallback(()=>{l(S,t,i,c,u,parseInt(j)).then(()=>{b()})},[l,S,t,i,c,u,j,b]),G=s.useCallback(r=>{var v;w(r.id),o(r.matchers),h(r.name),p(r.chartColor),I(r.sourceId),N(((v=r.budget)==null?void 0:v.toString())||"")},[]),B=s.useMemo(()=>J(C,d,x,G,m),[G,C,d,x,m]);return e.jsxs(e.Fragment,{children:[e.jsx("h2",{children:"Group Settings"}),e.jsxs(F,{className:"mb-2",children:[e.jsx(g,{children:e.jsx(y.Control,{placeholder:"Enter Label",value:i,onChange:r=>h(r.target.value)})}),e.jsx(g,{children:e.jsx(L,{selected:t,options:t,onChange:o})}),e.jsx(g,{sm:2,children:e.jsx(y.Control,{placeholder:"Enter Budget",type:"number",step:"any",min:"1",value:j,onChange:r=>N(r.target.value)})}),e.jsx(g,{sm:1,children:e.jsx(y.Control,{type:"color",value:c,onChange:r=>p(r.target.value),title:"Choose your color"})}),e.jsx(g,{children:e.jsxs(y.Select,{"aria-label":"Source Selector",value:u,onChange:r=>I(r.target.value),children:[e.jsx("option",{children:"Select Source"}),m.map((r,v)=>e.jsx("option",{value:r.id,children:r.name},`source-${v}`))]})})]}),e.jsx(F,{children:e.jsxs(g,{className:"text-end",children:[e.jsx(R,{className:"mx-2",disabled:!i||t.length===0||!c||!u,onClick:S?A:T,children:S?"Update":"Add Group"}),e.jsx(R,{variant:"outline-secondary",onClick:b,children:"Clear"})]})}),e.jsx(F,{children:e.jsxs(g,{children:[e.jsx("p",{children:f}),e.jsx(P,{colDefs:B,rowData:n,components:_})]})})]})},te=$(O);export{O as GroupSettings,te as default};
