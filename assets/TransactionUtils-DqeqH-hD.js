import{u as g,y as M,z as C,r as E,E as N,H as O,I as D}from"./vendor-BC_dpYi7.js";import{h as Y}from"./ApiBase-DXA55t6X.js";import{E as A,Q as d}from"./index-BxcUTzTY.js";const $=Array(13).fill("").map((e,t)=>{if(t===0)return{label:"Select Month",value:""};const a=new Date(0,t-1);return{label:a.toLocaleString("en-GB",{month:"long"}),value:(a.getMonth()+1).toLocaleString("en-GB",{minimumIntegerDigits:2,maximumFractionDigits:0,useGrouping:!1})}}),B=Array(6).fill(new Date().getFullYear()).map((e,t)=>{if(t===0)return{label:"Select Year",value:""};const a=e-(t-1);return{label:a.toString(),value:a}}),F=[{label:"Select Account Type",value:""},{label:"Savings/Current Account",value:"account"},{label:"Credit Card",value:"creditCard"}],_=(e,t,a)=>C({queryKey:[...d.TRANSACTIONS,e,t],meta:{endpoint:`${A.TRANSACTIONS}consolidated/${e}-${t}`},enabled:!!(e&&t)}),G=()=>{var a,n;const e=g(),t=(n=(a=e.getDefaultOptions().queries)==null?void 0:a.meta)==null?void 0:n.baseUrl;return M({mutationFn:s=>Y(`${t}${A.TRANSACTIONS}${s.accountType}`,s.payload),onSuccess:()=>{e.invalidateQueries({queryKey:d.TRANSACTIONS})}})};function q(e,t,a){const n=g(),s=_(e,t),o=n.getQueryData(d.SOURCE_SETTINGS),c=n.getQueryData(d.CATEGORY_SETTINGS);return[E.useMemo(()=>{var i;return s.data?(i=s.data)==null?void 0:i.map(y=>{const u=c==null?void 0:c.find(r=>r.matchers.some(m=>{const p=m.split(" "),b=p.filter(f=>y.transactionSource.includes(f));return p.length===b.length})),l=o==null?void 0:o.find(r=>r.id===(u==null?void 0:u.sourceId));return{...y,category:u,source:l}}):[]},[c,o,s.data]),s]}const h="dd/MM/yyyy",I="dd MMM yyyy",R=(e,t=h)=>D(e,t,new Date),L=(e,t=I)=>N(O(e),t),S=(e=[])=>e.reduce((t,a)=>(t+=typeof a=="number"?a:a.amount,t),0),P=e=>e.map(t=>({date:R(t[0]),transactionSource:t[1],amount:Number(t[2].replaceAll(",",""))})),j=e=>{const t=Object.groupBy(e,a=>{var n;return((n=a.source)==null?void 0:n.name)??"others"});return delete t.others,Object.keys(t).map(a=>{var i,y,u;const n=(y=(i=t[a])==null?void 0:i[0].source)==null?void 0:y.isExpense,s=((u=t[a])==null?void 0:u[0].accountType)==="account",o=Object.groupBy(t[a]??[],l=>{var r;return((r=l.category)==null?void 0:r.name)??"misc"}),c=Object.keys(o).map(l=>{var m,p;const r=S(o[l]);return{categoryName:l,amount:r,budget:(p=(m=o[l])==null?void 0:m[0].category)==null?void 0:p.budget}}),T=S(c);return{title:a,isExpense:n,isAccount:s,total:T,transactions:c}})};export{F as A,B as L,$ as M,P as a,G as b,L as f,j as g,S as t,q as u};
